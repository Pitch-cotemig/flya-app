name: ğŸ” Verificar Pull Request

on:
  pull_request:
    types: [opened, edited, synchronize, reopened]

jobs:
  validate-pr:
    runs-on: ubuntu-latest
    steps:
      - name: ğŸ” Verificar tÃ­tulo da PR
        uses: actions/github-script@v7
        with:
          script: |
            const prTitle = context.payload.pull_request.title;
            const titleRegex = /^\[FLYA\] - .+/;

            if (!titleRegex.test(prTitle)) {
              core.setFailed("âŒ O tÃ­tulo da PR deve comeÃ§ar com '[FLYA] - ' seguido de uma descriÃ§Ã£o.");
            } else {
              console.log("âœ… TÃ­tulo vÃ¡lido");
            }

      - name: ğŸ“ Verificar se hÃ¡ descriÃ§Ã£o na PR
        uses: actions/github-script@v7
        with:
          script: |
            const body = context.payload.pull_request.body;
            if (!body || body.trim().length < 10) {
              core.setFailed("âŒ A descriÃ§Ã£o da PR estÃ¡ vazia ou muito curta.");
            } else {
              console.log("âœ… DescriÃ§Ã£o presente");
            }

      - name: â˜‘ï¸ Verificar checklist marcado
        uses: actions/github-script@v7
        with:
          script: |
            const body = context.payload.pull_request.body;
            const checklistItems = [
              "- [x] Me atribuÃ­ como responsÃ¡vel por esta PR",
              "- [x] Resolvi conflitos de merge (se houver)",
              "- [x] A PR estÃ¡ seguindo o padrÃ£o de nomenclatura do tÃ­tulo",
              "- [x] Atualizei/adicionei testes",
              "- [x] Revisei se hÃ¡ prints ou cÃ³digos de debug para remover"
            ];

            const allChecked = checklistItems.every(item => body.includes(item));
            if (!allChecked) {
              core.setFailed("âŒ Nem todos os itens obrigatÃ³rios do checklist estÃ£o marcados.");
            } else {
              console.log("âœ… Checklist completo");
            }
